import{u as O,r as o,k as h,b as P,c as F,w as s,a as r,i as E,o as c,d as u,p as w,f as J,g as A,h as z,e as g,t as D}from"./index-CDzqZl3V.js";const G={key:0},H={key:1},K={class:"d-flex flex-column gap-4 mt-6"},X={__name:"Create",setup(Q){const M=P(),T=O(),U=E("notify"),k=o(null),_=o(!1),f=o(""),m=o(""),y=o(""),b=o(""),d=o(""),x=o(""),V=o(!1),p=o(""),i=o(""),a={required:t=>!!t||"This field is required",positiveNumber:t=>t&&parseFloat(t)>=0||"Must be a positive number",positiveInteger:t=>t&&parseInt(t)>0||"Must be a positive integer",maxAmount:t=>!m.value||parseFloat(t)>=parseFloat(m.value)||"Maximum amount must be greater than minimum amount",maxDuration:t=>!d.value||parseInt(t)>=parseInt(d.value)||"Maximum duration must be greater than minimum duration"},C=h(()=>({name:f.value,min_amount:parseFloat(m.value),max_amount:parseFloat(y.value),interest_rate:parseFloat(b.value),min_duration_months:parseInt(d.value),max_duration_months:parseInt(x.value)})),N=h(()=>M.currentRoute.value.query.isFund),B=async()=>{var t,e;if(_.value){V.value=!0,p.value="",i.value="";try{let n;N?n="loans/fund-type/":n="loans/type/",console.log(n),await T.fetchData(n,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(C.value)}),i.value="Loan product added successfully!",U("Loan product added successfully!"),q(),M.push("/personnel"),window.location.reload()}catch(n){console.error(n),p.value=((e=(t=n.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to add loan product"}finally{V.value=!1}}},q=()=>{f.value="",m.value="",y.value="",b.value="",d.value="",x.value="",p.value="",i.value||(i.value=""),k.value&&k.value.resetValidation()};return(t,e)=>{const n=r("v-card-title"),v=r("v-text-field"),I=r("v-alert"),S=r("v-btn"),L=r("v-form"),R=r("v-card-text"),j=r("v-card");return c(),F(j,{class:"mx-auto my-12","max-width":"500"},{default:s(()=>[u(n,{class:"text-h5 text-center py-4"},{default:s(()=>[N.value?(c(),w("span",G,"Add Fund Type")):(c(),w("span",H,"Add Loan Type"))]),_:1}),u(R,null,{default:s(()=>[u(L,{ref_key:"form",ref:k,modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=l=>_.value=l),onSubmit:J(B,["prevent"])},{default:s(()=>[u(v,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l),label:"Loan Type Name",rules:[a.required]},null,8,["modelValue","rules"]),u(v,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),label:"Minimum Amount",type:"number",rules:[a.required,a.positiveNumber]},null,8,["modelValue","rules"]),u(v,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=l=>y.value=l),label:"Maximum Amount",type:"number",rules:[a.required,a.positiveNumber,a.maxAmount]},null,8,["modelValue","rules"]),u(v,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=l=>b.value=l),label:"Interest Rate (%)",type:"number",step:"0.01",rules:[a.required,a.positiveNumber]},null,8,["modelValue","rules"]),u(v,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=l=>d.value=l),label:"Minimum Duration (Months)",type:"number",rules:[a.required,a.positiveInteger]},null,8,["modelValue","rules"]),u(v,{modelValue:x.value,"onUpdate:modelValue":e[5]||(e[5]=l=>x.value=l),label:"Maximum Duration (Months)",type:"number",rules:[a.required,a.positiveInteger,a.maxDuration]},null,8,["modelValue","rules"]),p.value?(c(),F(I,{key:0,type:"error",class:"mt-4"},{default:s(()=>[g(D(p.value),1)]),_:1})):A("",!0),i.value?(c(),F(I,{key:1,type:"success",class:"mt-4"},{default:s(()=>[g(D(i.value),1)]),_:1})):A("",!0),z("div",K,[u(S,{color:"primary",type:"submit",block:"",loading:V.value,disabled:!_.value},{default:s(()=>e[7]||(e[7]=[g(" Save Product ")])),_:1},8,["loading","disabled"]),u(S,{color:"secondary",block:"",onClick:q,disabled:V.value},{default:s(()=>e[8]||(e[8]=[g(" Reset Form ")])),_:1},8,["disabled"])])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}};export{X as default};

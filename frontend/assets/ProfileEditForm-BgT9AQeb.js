import{u as D,k as E,r as f,m as P,c as y,w as r,a as s,b as T,i as j,o as V,d as t,e as v,f as B,g as F,h as A,t as h}from"./index-CDzqZl3V.js";const H={class:"d-flex justify-space-between mt-6"},M={__name:"ProfileEditForm",setup(J){const b=T(),p=D(),x=j("notify"),n=E(()=>p.currentUser),w=f(null),d=f(!0),a=P({id:n.value.id,username:n.value.username||"",first_name:n.value.first_name||"",last_name:n.value.last_name||"",email:n.value.email||""}),c=f(!1),i=f(""),u={required:o=>!!o||"This field is required",email:o=>/.+@.+\..+/.test(o)||"Email must be valid"},g=async()=>{if(!d.value)return;c.value=!0,i.value="";const o={...a};o.password||delete o.password;try{await p.fetchData(`users/${n.value.id}/`,{headers:{"Content-Type":"application/json"},method:"PATCH",body:JSON.stringify(o)}),x("Profile updated successfully!"),await p.fetchCurrentUser(!0),b.push({name:"profile"}),window.location.reload()}catch(e){i.value=e.message||"Failed to update profile"}finally{c.value=!1}};return(o,e)=>{const C=s("v-card-title"),m=s("v-text-field"),U=s("v-divider"),N=s("v-alert"),_=s("v-btn"),S=s("v-form"),q=s("v-card-text"),k=s("v-card");return V(),y(k,{class:"mx-auto my-12","max-width":"600"},{default:r(()=>[t(C,{class:"text-h5 text-center py-4"},{default:r(()=>e[5]||(e[5]=[v(" Edit Your Profile ")])),_:1}),t(q,null,{default:r(()=>[t(S,{ref_key:"form",ref:w,modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=l=>d.value=l),onSubmit:B(g,["prevent"])},{default:r(()=>[t(m,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=l=>a.username=l),label:"Username",rules:[u.required]},null,8,["modelValue","rules"]),t(m,{modelValue:a.first_name,"onUpdate:modelValue":e[1]||(e[1]=l=>a.first_name=l),label:"First Name",rules:[u.required]},null,8,["modelValue","rules"]),t(m,{modelValue:a.last_name,"onUpdate:modelValue":e[2]||(e[2]=l=>a.last_name=l),label:"Last Name",rules:[u.required]},null,8,["modelValue","rules"]),t(m,{modelValue:a.email,"onUpdate:modelValue":e[3]||(e[3]=l=>a.email=l),label:"Email",type:"email",rules:[u.required,u.email],disabled:""},null,8,["modelValue","rules"]),t(U,{class:"my-4"}),i.value?(V(),y(N,{key:0,type:"error",class:"mt-4"},{default:r(()=>[v(h(i.value),1)]),_:1})):F("",!0),A("div",H,[t(_,{color:"secondary",to:{name:"profile"}},{default:r(()=>e[6]||(e[6]=[v(" Cancel ")])),_:1}),t(_,{color:"primary",type:"submit",loading:c.value,disabled:!d.value},{default:r(()=>e[7]||(e[7]=[v(" Save Changes ")])),_:1},8,["loading","disabled"])])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}};export{M as default};
